package com.andersostby.webhook.crypto

import org.junit.jupiter.api.Assertions.assertTrue
import org.junit.jupiter.api.Test
import org.junit.jupiter.api.assertThrows

internal class HmacTest {
    private val signature = "sha1=f19d06bdab387ee344977b17d121369174b447d4"
    private val secret = "Hemmelig"
    private val payload = "{\"action\":\"published\",\"package\":{\"id\":113791,\"name\":\"house-gh-webhook\",\"package_type\":\"docker\",\"html_url\":\"https://github.com/andersostby/house-gh-webhook/packages/113791\",\"created_at\":\"2020-01-25T23:35:46Z\",\"updated_at\":\"2020-01-25T23:35:46Z\",\"owner\":{\"login\":\"andersostby\",\"id\":3635938,\"node_id\":\"MDQ6VXNlcjM2MzU5Mzg=\",\"avatar_url\":\"https://avatars0.githubusercontent.com/u/3635938?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/andersostby\",\"html_url\":\"https://github.com/andersostby\",\"followers_url\":\"https://api.github.com/users/andersostby/followers\",\"following_url\":\"https://api.github.com/users/andersostby/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/andersostby/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/andersostby/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/andersostby/subscriptions\",\"organizations_url\":\"https://api.github.com/users/andersostby/orgs\",\"repos_url\":\"https://api.github.com/users/andersostby/repos\",\"events_url\":\"https://api.github.com/users/andersostby/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/andersostby/received_events\",\"type\":\"User\",\"site_admin\":false},\"package_version\":{\"id\":718188,\"version\":\"9e9da93\",\"summary\":\"\",\"body\":\"\",\"body_html\":\"\",\"manifest\":\"{\\n   \\\"schemaVersion\\\": 2,\\n   \\\"mediaType\\\": \\\"application/vnd.docker.distribution.manifest.v2+json\\\",\\n   \\\"config\\\": {\\n      \\\"mediaType\\\": \\\"application/vnd.docker.container.image.v1+json\\\",\\n      \\\"size\\\": 7282,\\n      \\\"digest\\\": \\\"sha256:315f24bc7ce6d1ed1f7390e1c242a7efb6788b77d36f72be9a0f6851a50d88fa\\\"\\n   },\\n   \\\"layers\\\": [\\n      {\\n         \\\"mediaType\\\": \\\"application/vnd.docker.image.rootfs.diff.tar.gzip\\\",\\n         \\\"size\\\": 26688847,\\n         \\\"digest\\\": \\\"sha256:7ddbc47eeb70dc7f08e410a6667948b87ff3883024eb41478b44ef9a81bf400c\\\"\\n      },\\n      {\\n         \\\"mediaType\\\": \\\"application/vnd.docker.image.rootfs.diff.tar.gzip\\\",\\n         \\\"size\\\": 35362,\\n         \\\"digest\\\": \\\"sha256:c1bbdc448b7263673926b8fe2e88491e5083a8b4b06ddfabf311f2fc5f27e2ff\\\"\\n      },\\n      {\\n         \\\"mediaType\\\": \\\"application/vnd.docker.image.rootfs.diff.tar.gzip\\\",\\n         \\\"size\\\": 845,\\n         \\\"digest\\\": \\\"sha256:8c3b70e3904492c753652606df4726430426f42ea56e06ea924d6fea7ae162a1\\\"\\n      },\\n      {\\n         \\\"mediaType\\\": \\\"application/vnd.docker.image.rootfs.diff.tar.gzip\\\",\\n         \\\"size\\\": 162,\\n         \\\"digest\\\": \\\"sha256:45d437916d5781043432f2d72608049dcf74ddbd27daa01a25fa63c8f1b9adc4\\\"\\n      },\\n      {\\n         \\\"mediaType\\\": \\\"application/vnd.docker.image.rootfs.diff.tar.gzip\\\",\\n         \\\"size\\\": 10842099,\\n         \\\"digest\\\": \\\"sha256:b5035666b1cd262e3117ca99ecbe11fc92c973a1164cd5c69bca60165f501520\\\"\\n      },\\n      {\\n         \\\"mediaType\\\": \\\"application/vnd.docker.image.rootfs.diff.tar.gzip\\\",\\n         \\\"size\\\": 208605851,\\n         \\\"digest\\\": \\\"sha256:6001d850392b5b125faec333cafce2b3d4230c864569b7c809d10cbd1d5f6736\\\"\\n      },\\n      {\\n         \\\"mediaType\\\": \\\"application/vnd.docker.image.rootfs.diff.tar.gzip\\\",\\n         \\\"size\\\": 99,\\n         \\\"digest\\\": \\\"sha256:fc62d44a2140e6b2256db47d551bbb268459d65a1d0d8b9d599e8c646b63146e\\\"\\n      },\\n      {\\n         \\\"mediaType\\\": \\\"application/vnd.docker.image.rootfs.diff.tar.gzip\\\",\\n         \\\"size\\\": 13334345,\\n         \\\"digest\\\": \\\"sha256:581761de7c2dd600f437a37a1e4a66d7cd80076a4246976861ea99f42b161a74\\\"\\n      }\\n   ]\\n}\",\"html_url\":\"https://github.com/andersostby/house-gh-webhook/packages/113791?version=9e9da93\",\"target_commitish\":\"master\",\"target_oid\":\"9e9da934375ef284aca2a6047b9e9f9cd7fb95ff\",\"created_at\":\"2020-01-27T23:47:17Z\",\"updated_at\":\"2020-01-27T23:47:17Z\",\"metadata\":[],\"package_files\":[{\"download_url\":\"https://github-production-registry-package-file-4f11e5.s3.amazonaws.com/236242117/68f4b500-3fcb-11ea-885b-18449179d358?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20200127%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20200127T234718Z&X-Amz-Expires=300&X-Amz-Signature=f8e70593c3c2fa18fb3e1dd74513b30109cccd45d85dadbf03c6ecacd0273914&X-Amz-SignedHeaders=host&actor_id=0&response-content-disposition=filename%3Dd11ce92e-23e8-4ba2-8719-c581e08724e7&response-content-type=application%2Foctet-stream\",\"id\":2118996,\"name\":\"d11ce92e-23e8-4ba2-8719-c581e08724e7\",\"sha256\":\"45d437916d5781043432f2d72608049dcf74ddbd27daa01a25fa63c8f1b9adc4\",\"sha1\":null,\"md5\":null,\"content_type\":\"application/octet-stream\",\"state\":\"uploaded\",\"size\":162,\"created_at\":\"2020-01-25T23:35:46Z\",\"updated_at\":\"2020-01-27T23:47:17Z\"},{\"download_url\":\"https://github-production-registry-package-file-4f11e5.s3.amazonaws.com/236242117/698d4b80-3fcb-11ea-9d71-c4278f4033cd?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20200127%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20200127T234718Z&X-Amz-Expires=300&X-Amz-Signature=51b9e5b03a774b33476293e1ebdf45541432f5822be5f0e5d2cddd1db8410a36&X-Amz-SignedHeaders=host&actor_id=0&response-content-disposition=filename%3Dac471a55-8e51-4a2d-a180-f8a5f31a90e8&response-content-type=application%2Foctet-stream\",\"id\":2118998,\"name\":\"ac471a55-8e51-4a2d-a180-f8a5f31a90e8\",\"sha256\":\"8c3b70e3904492c753652606df4726430426f42ea56e06ea924d6fea7ae162a1\",\"sha1\":null,\"md5\":null,\"content_type\":\"application/octet-stream\",\"state\":\"uploaded\",\"size\":845,\"created_at\":\"2020-01-25T23:35:47Z\",\"updated_at\":\"2020-01-27T23:47:17Z\"},{\"download_url\":\"https://github-production-registry-package-file-4f11e5.s3.amazonaws.com/236242117/698d4b80-3fcb-11ea-8849-0bbfe35a29d5?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20200127%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20200127T234718Z&X-Amz-Expires=300&X-Amz-Signature=2fbf69768f979ca71a980f3cfdcac2a7975e4d01559fd0789476ccd9c0606886&X-Amz-SignedHeaders=host&actor_id=0&response-content-disposition=filename%3D1389ce91-4174-42ed-badf-f244e883880b&response-content-type=application%2Foctet-stream\",\"id\":2118999,\"name\":\"1389ce91-4174-42ed-badf-f244e883880b\",\"sha256\":\"c1bbdc448b7263673926b8fe2e88491e5083a8b4b06ddfabf311f2fc5f27e2ff\",\"sha1\":null,\"md5\":null,\"content_type\":\"application/octet-stream\",\"state\":\"uploaded\",\"size\":35362,\"created_at\":\"2020-01-25T23:35:47Z\",\"updated_at\":\"2020-01-27T23:47:17Z\"},{\"download_url\":\"https://github-production-registry-package-file-4f11e5.s3.amazonaws.com/236242117/6a25e200-3fcb-11ea-83e3-500dd48852c4?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20200127%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20200127T234718Z&X-Amz-Expires=300&X-Amz-Signature=b07054ad656a0a7d05a298e0b7725dfc386d93d18f9b0ab3aaaeb224c13a25cf&X-Amz-SignedHeaders=host&actor_id=0&response-content-disposition=filename%3D6ec6d281-697a-4ed2-b8c6-2fdefd80227b&response-content-type=application%2Foctet-stream\",\"id\":2119000,\"name\":\"6ec6d281-697a-4ed2-b8c6-2fdefd80227b\",\"sha256\":\"7ddbc47eeb70dc7f08e410a6667948b87ff3883024eb41478b44ef9a81bf400c\",\"sha1\":null,\"md5\":null,\"content_type\":\"application/octet-stream\",\"state\":\"uploaded\",\"size\":26688847,\"created_at\":\"2020-01-25T23:35:48Z\",\"updated_at\":\"2020-01-27T23:47:17Z\"},{\"download_url\":\"https://github-production-registry-package-file-4f11e5.s3.amazonaws.com/236242117/6befa580-3fcb-11ea-8ae3-81d3f9ef8b21?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20200127%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20200127T234718Z&X-Amz-Expires=300&X-Amz-Signature=bada93c1c94b452cdf59f6860625a500a2b4e4b4de3e72b9eeff571cb7bc85bb&X-Amz-SignedHeaders=host&actor_id=0&response-content-disposition=filename%3Dfcc09473-74f5-40f7-8785-30e770c1e757&response-content-type=application%2Foctet-stream\",\"id\":2119002,\"name\":\"fcc09473-74f5-40f7-8785-30e770c1e757\",\"sha256\":\"6001d850392b5b125faec333cafce2b3d4230c864569b7c809d10cbd1d5f6736\",\"sha1\":null,\"md5\":null,\"content_type\":\"application/octet-stream\",\"state\":\"uploaded\",\"size\":208605851,\"created_at\":\"2020-01-25T23:35:51Z\",\"updated_at\":\"2020-01-27T23:47:17Z\"},{\"download_url\":\"https://github-production-registry-package-file-4f11e5.s3.amazonaws.com/236242117/6befa580-3fcb-11ea-8dd1-289c4794b649?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20200127%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20200127T234718Z&X-Amz-Expires=300&X-Amz-Signature=97674c29236b09dabdc22369efef6a8dec4c85e1ae5ce32e4ef8066ee317eeef&X-Amz-SignedHeaders=host&actor_id=0&response-content-disposition=filename%3De0f5bc9c-d79e-4c19-b6b1-8089b2cdf4bb&response-content-type=application%2Foctet-stream\",\"id\":2119003,\"name\":\"e0f5bc9c-d79e-4c19-b6b1-8089b2cdf4bb\",\"sha256\":\"b5035666b1cd262e3117ca99ecbe11fc92c973a1164cd5c69bca60165f501520\",\"sha1\":null,\"md5\":null,\"content_type\":\"application/octet-stream\",\"state\":\"uploaded\",\"size\":10842099,\"created_at\":\"2020-01-25T23:35:51Z\",\"updated_at\":\"2020-01-27T23:47:17Z\"},{\"download_url\":\"https://github-production-registry-package-file-4f11e5.s3.amazonaws.com/236242117/57dcad00-415f-11ea-8953-a437bd31bf6a?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20200127%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20200127T234718Z&X-Amz-Expires=300&X-Amz-Signature=e33b8588344320950896c91019c8484a4a7cf6bf4ce3226eb27a7742f235a332&X-Amz-SignedHeaders=host&actor_id=0&response-content-disposition=filename%3Dc2265fe2-3be3-4e21-a58d-d2eb0a3a1697&response-content-type=application%2Foctet-stream\",\"id\":2153268,\"name\":\"c2265fe2-3be3-4e21-a58d-d2eb0a3a1697\",\"sha256\":\"fc62d44a2140e6b2256db47d551bbb268459d65a1d0d8b9d599e8c646b63146e\",\"sha1\":null,\"md5\":null,\"content_type\":\"application/octet-stream\",\"state\":\"uploaded\",\"size\":98,\"created_at\":\"2020-01-27T23:47:14Z\",\"updated_at\":\"2020-01-27T23:47:17Z\"},{\"download_url\":\"https://github-production-registry-package-file-4f11e5.s3.amazonaws.com/236242117/57dcad00-415f-11ea-8f35-0ca26b43e22f?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20200127%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20200127T234718Z&X-Amz-Expires=300&X-Amz-Signature=f5243c9936fa1f7b7f009310fe2b61cd5c242ff3e4ce35d7f61edc1249b7a391&X-Amz-SignedHeaders=host&actor_id=0&response-content-disposition=filename%3D5bc9a0b2-f6c5-462e-8576-a00573f7a316&response-content-type=application%2Foctet-stream\",\"id\":2153269,\"name\":\"5bc9a0b2-f6c5-462e-8576-a00573f7a316\",\"sha256\":\"581761de7c2dd600f437a37a1e4a66d7cd80076a4246976861ea99f42b161a74\",\"sha1\":null,\"md5\":null,\"content_type\":\"application/octet-stream\",\"state\":\"uploaded\",\"size\":13334344,\"created_at\":\"2020-01-27T23:47:14Z\",\"updated_at\":\"2020-01-27T23:47:17Z\"},{\"download_url\":\"https://github-production-registry-package-file-4f11e5.s3.amazonaws.com/236242117/590dda00-415f-11ea-86b0-fa1a8b3244ea?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20200127%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20200127T234718Z&X-Amz-Expires=300&X-Amz-Signature=111dd8eca626e4cd3e233031991cccf09b135b608bd61839b74ce028853e1f64&X-Amz-SignedHeaders=host&actor_id=0&response-content-disposition=filename%3Da60202fd-de86-4faf-a77d-acf1c977d5de&response-content-type=application%2Foctet-stream\",\"id\":2153270,\"name\":\"a60202fd-de86-4faf-a77d-acf1c977d5de\",\"sha256\":\"315f24bc7ce6d1ed1f7390e1c242a7efb6788b77d36f72be9a0f6851a50d88fa\",\"sha1\":null,\"md5\":null,\"content_type\":\"application/octet-stream\",\"state\":\"uploaded\",\"size\":7282,\"created_at\":\"2020-01-27T23:47:16Z\",\"updated_at\":\"2020-01-27T23:47:17Z\"}],\"author\":{\"login\":\"github-actions[bot]\",\"id\":41898282,\"node_id\":\"MDM6Qm90NDE4OTgyODI=\",\"avatar_url\":\"https://avatars2.githubusercontent.com/in/15368?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/github-actions%5Bbot%5D\",\"html_url\":\"https://github.com/apps/github-actions\",\"followers_url\":\"https://api.github.com/users/github-actions%5Bbot%5D/followers\",\"following_url\":\"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions\",\"organizations_url\":\"https://api.github.com/users/github-actions%5Bbot%5D/orgs\",\"repos_url\":\"https://api.github.com/users/github-actions%5Bbot%5D/repos\",\"events_url\":\"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/github-actions%5Bbot%5D/received_events\",\"type\":\"Bot\",\"site_admin\":false},\"installation_command\":\"\"},\"registry\":{\"about_url\":\"https://help.github.com/about-github-package-registry\",\"name\":\"GitHub docker registry\",\"type\":\"docker\",\"url\":\"https://docker.pkg.github.com/andersostby/house-gh-webhook\",\"vendor\":\"GitHub Inc\"}},\"repository\":{\"id\":236242117,\"node_id\":\"MDEwOlJlcG9zaXRvcnkyMzYyNDIxMTc=\",\"name\":\"house-gh-webhook\",\"full_name\":\"andersostby/house-gh-webhook\",\"private\":false,\"owner\":{\"login\":\"andersostby\",\"id\":3635938,\"node_id\":\"MDQ6VXNlcjM2MzU5Mzg=\",\"avatar_url\":\"https://avatars0.githubusercontent.com/u/3635938?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/andersostby\",\"html_url\":\"https://github.com/andersostby\",\"followers_url\":\"https://api.github.com/users/andersostby/followers\",\"following_url\":\"https://api.github.com/users/andersostby/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/andersostby/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/andersostby/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/andersostby/subscriptions\",\"organizations_url\":\"https://api.github.com/users/andersostby/orgs\",\"repos_url\":\"https://api.github.com/users/andersostby/repos\",\"events_url\":\"https://api.github.com/users/andersostby/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/andersostby/received_events\",\"type\":\"User\",\"site_admin\":false},\"html_url\":\"https://github.com/andersostby/house-gh-webhook\",\"description\":null,\"fork\":false,\"url\":\"https://api.github.com/repos/andersostby/house-gh-webhook\",\"forks_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/forks\",\"keys_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/teams\",\"hooks_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/hooks\",\"issue_events_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/events\",\"assignees_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/tags\",\"blobs_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/languages\",\"stargazers_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/stargazers\",\"contributors_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/contributors\",\"subscribers_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/subscribers\",\"subscription_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/subscription\",\"commits_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/merges\",\"archive_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/downloads\",\"issues_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/andersostby/house-gh-webhook/deployments\",\"created_at\":\"2020-01-25T23:06:24Z\",\"updated_at\":\"2020-01-27T23:45:39Z\",\"pushed_at\":\"2020-01-27T23:45:36Z\",\"git_url\":\"git://github.com/andersostby/house-gh-webhook.git\",\"ssh_url\":\"git@github.com:andersostby/house-gh-webhook.git\",\"clone_url\":\"https://github.com/andersostby/house-gh-webhook.git\",\"svn_url\":\"https://github.com/andersostby/house-gh-webhook\",\"homepage\":null,\"size\":66,\"stargazers_count\":0,\"watchers_count\":0,\"language\":\"Kotlin\",\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":true,\"has_pages\":false,\"forks_count\":0,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":0,\"license\":{\"key\":\"mit\",\"name\":\"MIT License\",\"spdx_id\":\"MIT\",\"url\":\"https://api.github.com/licenses/mit\",\"node_id\":\"MDc6TGljZW5zZTEz\"},\"forks\":0,\"open_issues\":0,\"watchers\":0,\"default_branch\":\"master\"},\"sender\":{\"login\":\"github-actions[bot]\",\"id\":41898282,\"node_id\":\"MDM6Qm90NDE4OTgyODI=\",\"avatar_url\":\"https://avatars2.githubusercontent.com/in/15368?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/github-actions%5Bbot%5D\",\"html_url\":\"https://github.com/apps/github-actions\",\"followers_url\":\"https://api.github.com/users/github-actions%5Bbot%5D/followers\",\"following_url\":\"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions\",\"organizations_url\":\"https://api.github.com/users/github-actions%5Bbot%5D/orgs\",\"repos_url\":\"https://api.github.com/users/github-actions%5Bbot%5D/repos\",\"events_url\":\"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/github-actions%5Bbot%5D/received_events\",\"type\":\"Bot\",\"site_admin\":false}}"

    @Test
    internal fun `verifiserer payload`() {
        val hmac = Hmac(
                secret = secret,
                signature = signature,
                payload = payload
        )
        assertTrue(hmac.verify())
    }

    @Test
    internal fun `feil secret kaster feil`() {
        val hmac = Hmac(
                secret = "FeilSecret",
                signature = signature,
                payload = payload
        )
        assertThrows<IllegalStateException> { (hmac.verify()) }
    }

    @Test
    internal fun `feil signature kaster feil`() {
        val hmac = Hmac(
                secret = secret,
                signature = signature.takeLast(40).reversed(),
                payload = payload
        )
        assertThrows<IllegalStateException> { (hmac.verify()) }
    }
}
